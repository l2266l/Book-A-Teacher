<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title id="page-title">Teacher Sign Up</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #c9e4de;
      padding: 20px;
      direction: ltr;
    }

    .form-container {
      max-width: 500px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
    }

    input,
    select {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    button {
      padding: 12px 20px;
      background-color: #faedcb;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
    }

    button:hover {
      background-color: #ffe8a8;
    }

    #language-toggle {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 16px;
      padding: 10px 16px;
    }
  </style>
</head>

<body>
  <button id="language-toggle">العربية</button>
  <div class="form-container">
    <h2 id="form-title">Teacher Sign Up</h2>
    <form id="signup-form">
      <label id="name-label">Full Name</label>
      <input type="text" id="name" required />

      <label id="email-label">Email</label>
      <input type="email" id="email" required />

      <label id="password-label">Password</label>
      <input type="password" id="password" required />

      <label id="whatsapp-label">WhatsApp Number</label>
      <input type="text" id="whatsapp" required />

      <label id="bank-label">Bank Name</label>
      <input type="text" id="bank" required />

      <label id="iban-label">IBAN</label>
      <input type="text" id="iban" required />

      <label id="title-label">Title</label>
      <select id="title">
        <!-- Initial mixed labels, untranslated until toggle -->
        <option value="Ms">Ms</option>
        <option value="Mr">Mr</option>
      </select>

      <label id="subject-label">Subject</label>
      <select id="subject">
        <option value="Mathematics">Mathematics</option>
        <option value="Physics">Physics</option>
        <option value="Biology">Biology</option>
        <option value="Chemistry">Chemistry</option>
        <option value="Science">Science</option>
        <option value="Arabic">Arabic</option>
        <option value="English">English</option>
        <option value="French">French</option>
        <option value="Chinese">Chinese</option>
        <option value="Islamic">Islamic</option>
      </select>

      <label id="grade-label">Grade</label>
      <select id="grade">
        <option value="Grade 1">Grade 1</option>
        <option value="Grade 2">Grade 2</option>
        <option value="Grade 3">Grade 3</option>
        <option value="Grade 4">Grade 4</option>
        <option value="Grade 5">Grade 5</option>
        <option value="Grade 6">Grade 6</option>
        <option value="Grade 7">Grade 7</option>
        <option value="Grade 8">Grade 8</option>
        <option value="Grade 9">Grade 9</option>
        <option value="Grade 10">Grade 10</option>
        <option value="Grade 11">Grade 11</option>
        <option value="Grade 12">Grade 12</option>
      </select>

      <label id="certificate-label">Upload Certificate</label>
      <input type="file" id="certificate" accept="application/pdf,image/*" required />

      <div style="text-align: center;">
       <button type="submit" id="submit-button">Sign Up</button>
      </div>

    </form>
  </div>

  <script>
    const translations = {
      ar: {
        "form-title": "تسجيل المعلمين",
        "name-label": "الاسم الكامل",
        "email-label": "البريد الإلكتروني",
        "password-label": "كلمة المرور",
        "whatsapp-label": "رقم الواتساب",
        "bank-label": "اسم البنك",
        "iban-label": "الآيبان",
        "title-label": "اللقب",
        "subject-label": "المادة",
        "grade-label": "الصف",
        "certificate-label": "تحميل الشهادة",
        "submit-button": "تسجيل",
        "language-toggle": "English",
        "page-title": "تسجيل المعلمين",
        "title-options": ["المعلمة", "الاستاذ"]
      },
      en: {
        "form-title": "Teacher Sign Up",
        "name-label": "Full Name",
        "email-label": "Email",
        "password-label": "Password",
        "whatsapp-label": "WhatsApp Number",
        "bank-label": "Bank Name",
        "iban-label": "IBAN",
        "title-label": "Title",
        "subject-label": "Subject",
        "grade-label": "Grade",
        "certificate-label": "Upload Certificate",
        "submit-button": "Sign Up",
        "language-toggle": "العربية",
        "page-title": "Teacher Sign Up",
        "title-options": ["معلمة", "استاذ"]
      },
      subjects: {
        ar: ["الرياضيات", "الفيزياء", "الأحياء", "الكيمياء", "العلوم", "اللغة العربية", "اللغة الإنجليزية", "اللغة الفرنسية", "اللغة الصينية", "الدراسات الإسلامية"],
        en: ["Mathematics", "Physics", "Biology", "Chemistry", "Science", "Arabic", "English", "French", "Chinese", "Islamic"]
      },
      grades: {
        ar: ["الصف الأول", "الصف الثاني", "الصف الثالث", "الصف الرابع", "الصف الخامس", "الصف السادس", "الصف السابع", "الصف الثامن", "الصف التاسع", "الصف العاشر", "الصف الحادي عشر", "الصف الثاني عشر"],
        en: ["Grade 1", "Grade 2", "Grade 3", "Grade 4", "Grade 5", "Grade 6", "Grade 7", "Grade 8", "Grade 9", "Grade 10", "Grade 11", "Grade 12"]
      }
    };

    let currentLang = 'en';

    document.getElementById('language-toggle').addEventListener('click', () => {
      currentLang = currentLang === 'en' ? 'ar' : 'en';
      document.body.dir = currentLang === 'ar' ? 'rtl' : 'ltr';

      // Translate all text elements by IDs
      for (const key in translations[currentLang]) {
        if (key === 'title-options') continue; // skip title options here
        const el = document.getElementById(key);
        if (el) el.textContent = translations[currentLang][key];
      }

      document.title = translations[currentLang]['page-title'];

      // Translate subject options
      const subjectSelect = document.getElementById('subject');
      subjectSelect.querySelectorAll('option').forEach((opt, idx) => {
        opt.textContent = translations.subjects[currentLang][idx];
      });

      // Translate grade options
      const gradeSelect = document.getElementById('grade');
      gradeSelect.querySelectorAll('option').forEach((opt, idx) => {
        opt.textContent = translations.grades[currentLang][idx];
      });

      // Translate title (gender) options ONLY when toggled
      const titleSelect = document.getElementById('title');
      const titleOptions = translations[currentLang]['title-options'];
      titleSelect.querySelectorAll('option').forEach((opt, idx) => {
        opt.textContent = titleOptions[idx];
      });

      // Update language toggle button text
      document.getElementById('language-toggle').textContent = translations[currentLang]['language-toggle'];
    });

    // Firebase config initialization placeholder (add your config here)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      databaseURL: "YOUR_DB_URL",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MSG_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);

    const storage = firebase.storage();
    const database = firebase.database();

    const form = document.getElementById('signup-form');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      const whatsapp = document.getElementById('whatsapp').value.trim();
      const bank = document.getElementById('bank').value.trim();
      const iban = document.getElementById('iban').value.trim();
      const title = document.getElementById('title').value;
      const subject = document.getElementById('subject').value;
      const grade = document.getElementById('grade').value;
      const certificateInput = document.getElementById('certificate');
      const certificateFile = certificateInput.files[0];

      if (!certificateFile) {
        alert(currentLang === 'ar' ? 'يرجى تحميل الشهادة.' : 'Please upload the certificate.');
        return;
      }

      try {
        // Create user with email and password
        const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);
        const uid = userCredential.user.uid;

        // Upload certificate to Firebase Storage
        const storageRef = storage.ref().child('certificates/' + uid + '_' + certificateFile.name);
        const uploadTaskSnapshot = await storageRef.put(certificateFile);
        const downloadURL = await uploadTaskSnapshot.ref.getDownloadURL();

        // Save user data to Firebase Realtime Database
        await database.ref('teachers/' + uid).set({
          name,
          email,
          whatsapp,
          bank,
          iban,
          title,
          subject,
          grade,
          certificateURL: downloadURL
        });

        alert(currentLang === 'ar' ? 'تم التسجيل بنجاح!' : 'Sign up successful!');

        // Redirect to subscription page after successful signup and upload
        window.location.href = 'subscription.html';

      } catch (error) {
        alert(error.message);
      }
    });
  </script>
</body>

</html>
